Bootstrap: docker
From: ubuntu:18.04

%post
apt-get update
apt-get install --yes wget vim sudo build-essential gfortran libatlas-base-dev

# Building MPICH3
RUN mkdir /software /build
cd /build
wget http://www.mpich.org/static/downloads/3.1.4/mpich-3.1.4.tar.gz
tar xvf mpich-3.1.4.tar.gz
mpich-3.1.4
bash ./configure
make -j 8 VERBOSE=1
make install
cd /
rm -rf /build
ldconfig
source LD_LIBRARY_PATH="/usr/lib:/usr/local/lib:${LD_LIBRARY_PATH}"
mkdir /hpl
cd /hpl
wget http://www.netlib.org/benchmark/hpl/hpl-2.3.tar.gz
tar xvf hpl-2.3.tar.gz -C /hpl --strip-component=1
cp ~/Make.ubuntu /hpl
make arch=ubuntu
cp ~/HPL.dat /hpl/bin/ubuntu

